# fil矿机怎么封装？封装的意义是什么

---
什么是封装？封装就是往你的矿机里存储数据，并且加密。每封装1T数据，即转化1T算力，每T算力需要10枚左右fil作为质押，gas消耗2枚左右，即单T的封装成本约12枚fil。

Filecoin存储数据封装！所谓封装，就是按照Filecoin的规定格式，把数据进行灌装，P1、P2、C1、C2就是打包灌装的过程。封装数据的过程就是P1、P2、C1、C2。P1就是切片装箱，需要AMDCPU（耗时几个小时）；P2就是生成文件的信息表也叫动态哈希列表DHT，一般需要显卡（几十分钟完事）；C1就是贴标签（几十秒就够，Gas费的主要消耗环节之一）；C2就是做零知识证明，一般需要多显卡（半个小时左右，Gas费的主要消耗环节之二）。

为什么矿机需要封装？说到底，Filecoin只是IPFS项目的激励层，作为一个分布式存储和共享文件的网络传输协议，IPFS的实质是存储和共享。而Filecoin的挖矿原理其实是存储和共享数据，从而获取官方的奖励，所以FIL矿机需要封存数据，这就是封装的过程。

当前几乎所有矿工存储的都是垃圾数据，只能获取官方设定的挖矿奖励。当IPFS项目落地应用后，矿工在封存真实数据时，能获取官方额外设定的存储收益和检索收益，为了这部分奖励，官方预留了3亿Filecoin，也是一笔非常丰厚的收益。

Filecoin挖矿可以简单拆分为worker和miner两个步骤。worker就是负责计算，将原始数据通过SDR算法进行数学计算，然后再将计算好的数据封装到硬盘的扇区中，并提交上链生成复制证明，矿工就获得了算力，这个过程需要消耗大量的CPU、内存和GPU资源。然后Filecoin网络再根据矿工所持有的算力分配区块打包的权利（也就是区块打包票选权），算力越大、赢票率越高，矿工在参与区块打包的时候需要重复提交时空证明，完成了时空证明的节点就可以获得区块打包的奖励。

Filecoin本质上是存储挖矿，矿工根据其实际封装数据量并向网络提交复制证明从而获得有效算力，有效算力越高，获得区块奖励的概率越大。算力越大的矿工，获得区块打包的权利或者概率越大，这是涉及两个参数：赢票率和出块率；赢票率就是获得选票的概率，出块率就是获得区块奖励的概率。

---

## Filecoin区块密封过程

首先，安装挖矿软件并运行；

然后，创建节点并加入网络，加入之后同步链数据、创建钱包地址；

最后，由于挖矿需要质押 FIL，因此需要购买或借贷 FIL，打入钱包地址中。

开始挖矿：获取存储订单，数据密封（扇区封装，耗时最长），生成复制证明，验证数据，形成有效算力，获得打包权，提交时空证明，获得出块奖励。

Filecoin是存储挖矿，矿工根据其实际封装了多少数据并向链上提交了复制证明从而获得有效算力（有效存力），有效算力越高，矿工获得区块奖励的概率越大。

算力越大的矿工，获得区块打包的权利或者概率越大，这里就有赢票率和出块率的参数。赢票率就是赢得选票的概率，出块率就是获得区块奖励的概率。

做个对比，比特币挖矿购买的矿机算力是不变的，买了矿机接入互联网之后，每天产生多少币是个固定的值；

而Filecoin是存储挖矿，Filecoin的算力是根据封装了多少有效数据来计算的，今天封装了1 T，算力就是1 T，而且算力还在不断积累。

需要注意的是，最短扇区生命周期被设置为6个月，最长的扇区生命周期由证明算法确定，初步而言最长扇区生命周期为18个月，即540天。扇区在其生命周期结束时会自然到期，此外，矿工也可以延长其扇区的周期。

因此，有效算力是挖矿的基础，矿工的算力越高，赢票率越大，相应获得区块奖励的可能性就越大，挖矿收益也相应越高。而扇区封装封装效率越快、有效算力增长速度自然越快，有效算力占比越高，其出块率也就相应越高，产币量就越大。

此时我们不得不提及扇区封装。用 PoRep (复制证明)对扇区进行封装，这是一个计算密集的过程，将产生该扇区唯一的标识码。一旦数据被封装，存储矿工将生成证明，运行SNARK来压缩证明；最后，将压缩后的结果提交给区块链，作为存储承诺的证明。

密封过程

1、empty packing（空的扇区，注入数据进入例如：32GB，形成未密封的扇区）

2、precommit1--precommit2（这里就开始密封了，文件碎片加密的方式是默克尔树列，最终要计算到默克尔树列的根植，p1预计耗时若干小时，p2预计耗时耗时几十分钟）

3、precommting（把precommit2计算得到的默克尔树根提交上链，以此证明矿机的加密能力，和能完成扇区密封）

4、wait seed （可以理解为等待一定时间，这里指一定的区块高度，每个区块间隔30s，这是目前主网的高度时间，具体等待的是：一个扇区计算到的随机数，用来抽查p2密封的扇区内文件碎片是否存储，零知识证明）

5、commiting1、2（抽出对应文件碎片，计算出到默克尔根的文件路径，c1预计耗时只需数十秒，c2预计耗时25分钟左右）

6、commit wait（提交c2计算的根，以证明文件碎片存储着）

7、finalize sector（扇区密封结束）

8、proving完成密封

这几个过程所消耗的时间，一般和各个公司的优化算法、硬件配置等有关。有效的算力是在完成这些步骤后产生的，而不像比特币矿机那样，购买多少算力就有多少算力，这个 Filecoin的算力通过时间逐渐累积

filecoin挖矿与传统挖矿对比

比特币挖矿所依靠的是算力，挖矿的过程也就是运算哈希算法并得到结果的过程。它依赖的是CPU、GPU 和 ASIC 这类高端芯片。

但是Filecoin与之不同的是，它不需要大量的运算，所以能源消耗也很小，但对带宽和硬盘硬件要求更高

矿工们通常在整个Filecoin网络中扮演两个角色：即存储矿工和检索矿工。

从本质上来说，存储矿工就是为Filecoin网络提供存储空间，为客户提供存储需求。而检索矿工则是在已有数据的情况下做的二次开发，为客户提供数据检索服务。

filecoin目前的中收益

1、存储收益：为需要存储内容的客户提供存储空间，以帮助他们保存内容碎片，你会获得存储收益

2、检索收益：提供检索服务、带宽，快速提供客户所需要的内容会获得检索收益

3、打包收益：将区块打包，每次确认一个区块，网络就会给一个奖励

另一个重要区别是比特币和Filecoin矿机的本质也不一样，矿机的本质是数据计算设备。但是 Filecoin矿机的本质是数据存储设备。

Filecoin的挖矿效率是与存储活跃度成比例的，直接向客户提供有用的存储服务（不像比特币的挖矿仅是为了维护区块链的共识）。

这种方式给矿工们提供了强有力的激励，促使他们尽可能多地聚集存储器，并将其租给客户进行储存。

Filecoin协议把这些聚集在一起的资源组成一个自我修复的存储网络，全世界人都可以依靠它。

