(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a6b97318"],{"107c":function(e,t,a){var s=a("d039"),r=a("da84"),l=r.RegExp;e.exports=s((function(){var e=l("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")}))},"129f":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},"14c3":function(e,t,a){var s=a("825a"),r=a("1626"),l=a("c6b6"),o=a("9263");e.exports=function(e,t){var a=e.exec;if(r(a)){var n=a.call(e,t);return null!==n&&s(n),n}if("RegExp"===l(e))return o.call(e,t);throw TypeError("RegExp#exec called on incompatible receiver")}},5246:function(e,t,a){"use strict";a("a8ce")},7164:function(e,t,a){},7392:function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],staticClass:"dialog-modal",on:{click:function(t){return t.target!==t.currentTarget?null:function(){return e.$emit("update:visible",!1)}.apply(null,arguments)}}},[a("div",{staticClass:"config-container"},[a("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:this.$t("Terminal.Theme"),name:"first"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:this.$t("Terminal.SelectTheme")},model:{value:e.theme,callback:function(t){e.theme=t},expression:"theme"}},e._l(e.themes,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1),e.theme?a("div",[a("p",{staticClass:"title"},[e._v(e._s(this.$t("Terminal.ThemeColors")))]),a("el-row",{staticClass:"theme-colors",attrs:{type:"flex"}},[a("el-col",{attrs:{span:8}},[a("div",{staticClass:"show-color",style:{backgroundColor:e.colors.background}}),a("div",[e._v("Background")])]),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"show-color",style:{backgroundColor:e.colors.foreground}}),a("div",[e._v("Foreground")])]),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"show-color",style:{backgroundColor:e.colors.cursor}}),a("div",[e._v("Cursor")])])],1),a("p",{staticClass:"title"},[e._v("ANSI Colors")]),a("el-row",{staticClass:"theme-colors",attrs:{type:"flex"}},[a("el-col",{attrs:{span:3}},[a("div",{staticClass:"show-color",style:{backgroundColor:e.colors.black}}),a("div",[e._v("Black")])]),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"show-color",style:{backgroundColor:e.colors.red}}),a("div",[e._v("Red")])]),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"show-color",style:{backgroundColor:e.colors.green}}),a("div",[e._v("Green")])]),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"show-color",style:{backgroundColor:e.colors.yellow}}),a("div",[e._v("Yellow")])]),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"show-color",style:{backgroundColor:e.colors.blue}}),a("div",[e._v("Blue")])]),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"show-color",style:{backgroundColor:e.colors.magenta}}),a("div",[e._v("Magenta")])]),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"show-color",style:{backgroundColor:e.colors.cyan}}),a("div",[e._v("Cyan")])]),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"show-color",style:{backgroundColor:e.colors.white}}),a("div",[e._v("White")])])],1),a("el-row",{staticClass:"theme-colors",attrs:{type:"flex"}},[a("el-col",{attrs:{span:3}},[a("div",{staticClass:"show-color",style:{backgroundColor:e.colors.brightBlack}}),a("div",[e._v("BrightBlack")])]),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"show-color",style:{backgroundColor:e.colors.brightRed}}),a("div",[e._v("BrightRed")])]),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"show-color",style:{backgroundColor:e.colors.brightGreen}}),a("div",[e._v("BrightGreen")])]),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"show-color",style:{backgroundColor:e.colors.brightYellow}}),a("div",[e._v("BrightYellow")])]),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"show-color",style:{backgroundColor:e.colors.brightBlue}}),a("div",[e._v("BrightBlue")])]),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"show-color",style:{backgroundColor:e.colors.brightMagenta}}),a("div",[e._v("BrightMagenta")])]),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"show-color",style:{backgroundColor:e.colors.brightCyan}}),a("div",[e._v("BrightCyan")])]),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"show-color",style:{backgroundColor:e.colors.brightWhite}}),a("div",[e._v("BrightWhite")])])],1)],1):e._e()],1)],1)],1)])},r=[],l=(a("b64b"),a("7f18")),o=a.n(l),n=Object.keys(o.a),i={name:"ThemeConfig",props:{visible:Boolean},data:function(){return{activeName:"first",themes:n,theme:window.localStorage.getItem("themeName")||null}},computed:{colors:function(){return this.theme?o.a[this.theme]:null}},watch:{theme:function(e){window.localStorage.setItem("themeName",e),this.$emit("setTheme",o.a[e])}}},c=i,d=(a("c71e"),a("2877")),u=Object(d["a"])(c,s,r,!1,null,"2e5b620c",null);t["a"]=u.exports},"841c":function(e,t,a){"use strict";var s=a("d784"),r=a("825a"),l=a("1d80"),o=a("129f"),n=a("577e"),i=a("dc4a"),c=a("14c3");s("search",(function(e,t,a){return[function(t){var a=l(this),s=void 0==t?void 0:i(t,e);return s?s.call(t,a):new RegExp(t)[e](n(a))},function(e){var s=r(this),l=n(e),i=a(t,s,l);if(i.done)return i.value;var d=s.lastIndex;o(d,0)||(s.lastIndex=0);var u=c(s,l);return o(s.lastIndex,d)||(s.lastIndex=d),null===u?-1:u.index}]}))},9263:function(e,t,a){"use strict";var s=a("577e"),r=a("ad6d"),l=a("9f7f"),o=a("5692"),n=a("7c73"),i=a("69f3").get,c=a("fce3"),d=a("107c"),u=RegExp.prototype.exec,h=o("native-string-replace",String.prototype.replace),v=u,g=function(){var e=/a/,t=/b*/g;return u.call(e,"a"),u.call(t,"a"),0!==e.lastIndex||0!==t.lastIndex}(),p=l.UNSUPPORTED_Y||l.BROKEN_CARET,f=void 0!==/()??/.exec("")[1],m=g||f||p||c||d;m&&(v=function(e){var t,a,l,o,c,d,m,b=this,C=i(b),x=s(e),k=C.raw;if(k)return k.lastIndex=b.lastIndex,t=v.call(k,x),b.lastIndex=k.lastIndex,t;var y=C.groups,_=p&&b.sticky,w=r.call(b),T=b.source,I=0,R=x;if(_&&(w=w.replace("y",""),-1===w.indexOf("g")&&(w+="g"),R=x.slice(b.lastIndex),b.lastIndex>0&&(!b.multiline||b.multiline&&"\n"!==x.charAt(b.lastIndex-1))&&(T="(?: "+T+")",R=" "+R,I++),a=new RegExp("^(?:"+T+")",w)),f&&(a=new RegExp("^"+T+"$(?!\\s)",w)),g&&(l=b.lastIndex),o=u.call(_?a:b,R),_?o?(o.input=o.input.slice(I),o[0]=o[0].slice(I),o.index=b.lastIndex,b.lastIndex+=o[0].length):b.lastIndex=0:g&&o&&(b.lastIndex=b.global?o.index+o[0].length:l),f&&o&&o.length>1&&h.call(o[0],a,(function(){for(c=1;c<arguments.length-2;c++)void 0===arguments[c]&&(o[c]=void 0)})),o&&y)for(o.groups=d=n(null),c=0;c<y.length;c++)m=y[c],d[m[0]]=o[m[1]];return o}),e.exports=v},"9f7f":function(e,t,a){var s=a("d039"),r=a("da84"),l=r.RegExp;t.UNSUPPORTED_Y=s((function(){var e=l("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),t.BROKEN_CARET=s((function(){var e=l("^r","gy");return e.lastIndex=2,null!=e.exec("str")}))},a8ce:function(e,t,a){},ac1f:function(e,t,a){"use strict";var s=a("23e7"),r=a("9263");s({target:"RegExp",proto:!0,forced:/./.exec!==r},{exec:r})},bd26:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",{style:e.backgroundColor},[a("el-main",[a("Terminal",{ref:"term",attrs:{"enable-zmodem":!0,connectURL:e.wsURL},on:{"background-color":e.onThemeBackground,"ws-data":e.onWsData}})],1),a("el-aside",{attrs:{width:"60px",center:""}},[a("el-menu",{attrs:{collapse:!0,"background-color":e.themeBackground,"text-color":"#ffffff"}},[a("el-menu-item",{attrs:{index:"0"},on:{click:function(t){e.dialogVisible=!e.dialogVisible}}},[a("i",{staticClass:"el-icon-setting"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(this.$t("Terminal.ThemeConfig")))])]),e.enableShare?a("el-menu-item",{attrs:{index:"1"},on:{click:function(t){e.shareDialogVisible=!e.shareDialogVisible}}},[a("i",{staticClass:"el-icon-share"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(this.$t("Terminal.Share")))])]):e._e(),e.displayOnlineUser?a("el-submenu",{attrs:{index:"2"}},[a("template",{slot:"title"},[a("i",{staticClass:"el-icon-s-custom"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(this.$t("Terminal.OnlineUsers")))])]),a("el-menu-item-group",[a("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(this.$t("Terminal.User"))+" "+e._s(e.onlineKeys.length))]),e._l(e.onlineUsersMap,(function(t,s){return a("el-menu-item",{key:s},[e._v(e._s(t.user))])}))],2)],2):e._e()],1)],1),a("ThemeConfig",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t},setTheme:e.handleChangeTheme}}),a("el-dialog",{attrs:{title:e.shareTitle,visible:e.shareDialogVisible,width:"30%","close-on-press-escape":!1,"close-on-click-modal":!1,center:""},on:{"update:visible":function(t){e.shareDialogVisible=t},close:e.shareDialogClosed}},[e.shareId?e._e():a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[a("el-form-item",{attrs:{label:this.$t("Terminal.ExpiredTime")}},[a("el-select",{attrs:{placeholder:this.$t("Terminal.SelectAction")},model:{value:e.expiredTime,callback:function(t){e.expiredTime=t},expression:"expiredTime"}},e._l(e.expiredOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),e.shareId?a("el-result",{attrs:{icon:"success",title:this.$t("Terminal.CreateSuccess")}},[a("template",{slot:"extra"})],2):e._e(),e.shareId?a("el-form",[a("el-form-item",{attrs:{label:this.$t("Terminal.LinkAddr")}},[a("el-input",{attrs:{readonly:"",value:e.shareURL}})],1),a("el-form-item",{attrs:{label:this.$t("Terminal.VerifyCode")}},[a("el-input",{attrs:{readonly:"",value:e.shareCode}})],1)],1):e._e(),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e.shareId?e._e():a("el-button",{attrs:{type:"primary"},on:{click:e.handleShareURlCreated}},[e._v(e._s(this.$t("Terminal.CreateLink")))]),e.shareId?a("el-button",{attrs:{type:"primary"},on:{click:e.copyShareURL}},[e._v(e._s(this.$t("Terminal.CopyLink"))+" ")]):e._e()],1)],1)],1)},r=[],l=(a("b0c0"),a("d3b7"),a("3ca3"),a("ddb0"),a("9861"),a("25f0"),a("fb6a"),a("ac1f"),a("841c"),a("99af"),a("b64b"),a("7ad4")),o=a("7392"),n=a("cf45"),i={components:{Terminal:l["a"],ThemeConfig:o["a"]},name:"Connection",data:function(){return{sessionId:"",enableShare:!1,dialogVisible:!1,themeBackground:"#1f1b1b",shareDialogVisible:!1,expiredTime:10,expiredOptions:[{label:"10m",value:10},{label:"20m",value:20},{label:"60m",value:60}],shareId:null,loading:!1,shareCode:null,shareInfo:null,onlineUsersMap:{},onlineKeys:[]}},computed:{wsURL:function(){return this.getConnectURL()},backgroundColor:function(){return{background:this.themeBackground}},shareTitle:function(){return this.shareId?this.$t("Terminal.Share"):this.$t("Terminal.CreateLink")},shareURL:function(){return this.shareId?this.generateShareURL():this.$t("Terminal.NoLink")},displayOnlineUser:function(){return this.onlineKeys.length>1}},methods:{getConnectURL:function(){var e="",t=this.$route.name;switch(t){case"Token":var a=this.$route.params,s=new URLSearchParams;s.append("type","token"),s.append("target_id",a.id),e=n["b"]+"/koko/ws/token/?"+s.toString();break;default:var r=new URLSearchParams(window.location.search.slice(1));e="".concat(n["b"],"/koko/ws/terminal/?").concat(r.toString())}return e},generateShareURL:function(){return"".concat(n["a"],"/koko/share/").concat(this.shareId,"/")},copyShareURL:function(){if(this.enableShare&&this.shareId){var e=this.generateShareURL();this.$log.debug("share URL: "+e);var t=this.$t("Terminal.LinkAddr"),a=this.$t("Terminal.VerifyCode"),s="".concat(t,"： ").concat(e,"\n").concat(a,": ").concat(this.shareCode);Object(n["c"])(s),this.$message(this.$t("Terminal.CopyShareURLSuccess"))}},onThemeBackground:function(e){this.themeBackground=e},onWsData:function(e,t){switch(e){case"TERMINAL_SESSION":var a=JSON.parse(t.data);this.sessionId=a.id,this.enableShare=a.enable_share;break;case"TERMINAL_SHARE":var s=JSON.parse(t.data);this.shareId=s.share_id,this.shareCode=s.code,this.loading=!1;break;case"TERMINAL_SHARE_JOIN":var r=JSON.parse(t.data),l=r.user_id+r.created;this.onlineUsersMap[l]=r,this.$log.debug(this.onlineUsersMap),this.updateOnlineCount();break;case"TERMINAL_SHARE_LEAVE":var o=JSON.parse(t.data),n=o.user_id+o.created;delete this.onlineUsersMap[n],this.updateOnlineCount();break;default:break}this.$log.debug("on ws data: ",t)},handleChangeTheme:function(e){this.$refs.term.term&&(this.$refs.term.term.setOption("theme",e),this.themeBackground=e.background),this.$log.debug(e)},handleShareURlCreated:function(){this.loading=!0,this.$refs.term&&this.$refs.term.createShareInfo(this.sessionId,this.expiredTime),this.$log.debug("分享请求数据： ",this.expiredTime,this.sessionId)},shareDialogClosed:function(){this.$log.debug("share dialog closed"),this.loading=!1,this.shareId=null,this.shareCode=null},updateOnlineCount:function(){var e=Object.keys(this.onlineUsersMap);this.$log.debug(e),this.onlineKeys=e}}},c=i,d=(a("5246"),a("2877")),u=Object(d["a"])(c,s,r,!1,null,"65e5c1fa",null);t["default"]=u.exports},c71e:function(e,t,a){"use strict";a("7164")},d784:function(e,t,a){"use strict";a("ac1f");var s=a("6eeb"),r=a("9263"),l=a("d039"),o=a("b622"),n=a("9112"),i=o("species"),c=RegExp.prototype;e.exports=function(e,t,a,d){var u=o(e),h=!l((function(){var t={};return t[u]=function(){return 7},7!=""[e](t)})),v=h&&!l((function(){var t=!1,a=/a/;return"split"===e&&(a={},a.constructor={},a.constructor[i]=function(){return a},a.flags="",a[u]=/./[u]),a.exec=function(){return t=!0,null},a[u](""),!t}));if(!h||!v||a){var g=/./[u],p=t(u,""[e],(function(e,t,a,s,l){var o=t.exec;return o===r||o===c.exec?h&&!l?{done:!0,value:g.call(t,a,s)}:{done:!0,value:e.call(a,t,s)}:{done:!1}}));s(String.prototype,e,p[0]),s(c,u,p[1])}d&&n(c[u],"sham",!0)}},fb6a:function(e,t,a){"use strict";var s=a("23e7"),r=a("e8b5"),l=a("68ee"),o=a("861d"),n=a("23cb"),i=a("50c4"),c=a("fc6a"),d=a("8418"),u=a("b622"),h=a("1dde"),v=h("slice"),g=u("species"),p=[].slice,f=Math.max;s({target:"Array",proto:!0,forced:!v},{slice:function(e,t){var a,s,u,h=c(this),v=i(h.length),m=n(e,v),b=n(void 0===t?v:t,v);if(r(h)&&(a=h.constructor,l(a)&&(a===Array||r(a.prototype))?a=void 0:o(a)&&(a=a[g],null===a&&(a=void 0)),a===Array||void 0===a))return p.call(h,m,b);for(s=new(void 0===a?Array:a)(f(b-m,0)),u=0;m<b;m++,u++)m in h&&d(s,u,h[m]);return s.length=u,s}})},fce3:function(e,t,a){var s=a("d039"),r=a("da84"),l=r.RegExp;e.exports=s((function(){var e=l(".","s");return!(e.dotAll&&e.exec("\n")&&"s"===e.flags)}))}}]);
//# sourceMappingURL=chunk-a6b97318.5176ebb9.js.map