# 服务、负载均衡和联网

Kubernetes 网络解决四方面的问题：

* 一个 Pod 中的容器之间通过本地回路（loopback）通信。
* 集群网络在不同 pod 之间提供通信。
* Service 资源允许你对外暴露 Pods 中运行的应用程序，以支持来自于集群外部的访问。
* 可以使用 Services 来发布仅供集群内部使用的服务。

## 使用拓扑键实现拓扑感知的流量路由(deprecated)

服务拓扑（Service Topology）可以让一个服务基于集群的 Node 拓扑进行流量路由。 例如，一个服务可以指定流量是被优先路由到一个和客户端在同一个 Node 或者在同一可用区域的端点。

### 拓扑感知的流量路由 

默认情况下，发往 ClusterIP 或者 NodePort 服务的流量可能会被路由到 服务的任一后端的地址。Kubernetes 1.7 允许将“外部”流量路由到接收到流量的 节点上的 Pod。对于 ClusterIP 服务，无法完成同节点优先的路由，你也无法 配置集群优选路由到同一可用区中的端点。 通过在 Service 上配置 topologyKeys，你可以基于来源节点和目标节点的 标签来定义流量路由策略。

通过对源和目的之间的标签匹配，作为集群操作者的你可以根据节点间彼此“较近”和“较远” 来定义节点集合。你可以基于符合自身需求的任何度量值来定义标签。 例如，在公有云上，你可能更偏向于把流量控制在同一区内，因为区间流量是有费用成本的， 而区内流量则没有。 其它常见需求还包括把流量路由到由 DaemonSet 管理的本地 Pod 上，或者 把将流量转发到连接在同一机架交换机的节点上，以获得低延时。

